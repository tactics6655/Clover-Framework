WITH RECURSIVE cte(id, comma_separated_string, value, pos) AS ( SELECT id, comma_separated_string, '', 1 FROM my_table UNION ALL SELECT id, comma_separated_string, CASE WHEN INSTR(SUBSTR(comma_separated_string, pos), ',') = 0 THEN SUBSTR(comma_separated_string, pos) ELSE SUBSTR(comma_separated_string, pos, INSTR(SUBSTR(comma_separated_string, pos), ',') - 1) END, pos + CASE WHEN INSTR(SUBSTR(comma_separated_string, pos), ',') = 0 THEN LENGTH(comma_separated_string) - pos + 1 ELSE INSTR(SUBSTR(comma_separated_string, pos), ',') END FROM cte WHERE pos <= LENGTH(comma_separated_string) ) SELECT id, value FROM cte WHERE value <> '';